figure()
out_beta_new = out_beta;
no_switch_sols=out_beta_new(n_switches_beta(:,1)<1);
no_switch_betas=beta_values(n_switches_beta(:,1)<1);
one_switch_sols=out_beta_new(n_switches_beta(:,1)>0);
one_switch_betas=beta_values(n_switches_beta(:,1)>0);
out_beta_new(out_beta==0) =nan(length(out_beta(out_beta==0)),1);

plot(no_switch_betas*pop,no_switch_sols, '--r', 'linewidth',2)
hold on
plot(one_switch_betas*pop,one_switch_sols,':g', 'linewidth',2)
plot(beta_values*pop,out_beta_new(:,2),'--m', 'linewidth',2)
plot(beta_values*pop,out_beta_new(:,3),'b', 'linewidth',2)
xlabel("\beta N")
ylabel("Economic Output")

%%
I0_values_plot1=[6.20526315789474	11.4105263157895	16.6157894736842	21.8210526315789	27.0263157894737	32.2315789473684	37.4368421052632	42.6421052631579	47.8473684210526	53.0526315789474	58.2578947368421	63.4631578947369	68.6684210526316	73.8736842105263 79.0789473684211];
I0_out_plot1=[1418.12684034984,1065.63766584131,805.256648851592,586.239005513561,391.592860572764,213.523841069198,47.7697419620420,-108.265885445181,-256.289497059977,-397.510504956667,-532.822830536382,-662.905791057206,-788.298216618422,-909.438222032878,-1026.11217507704];
I0_values_plot2=[79.0789473684211	84.2842105263158	89.4894736842105	94.6947368421053	99.9000000000000];
I0_out_plot2=[-1026.11217507704,-1127.68211148849,-1214.96695468697,-1292.11166422283,-1361.63363812866];
I0_values_plot3 = [63.4631578947369	68.6684210526316	73.8736842105263	79.0789473684211	84.2842105263158	89.4894736842105	94.6947368421053	99.9000000000000];
I0_out_plot3 = [-959.030532343648,-1036.04826363825,-1107.56100559015,-1174.30355602131,-1236.87272787899,-1295.75988520723,-1351.37441384297,-1404.06100220232];
I0_out_plot4 = [-960.214886012200,-1039.20182051528,-1113.01666699886,-1181.95871839508,-1246.73953594159,-1307.71189799238,-1365.22155069387,-1419.83836148859];
figure()
plot(I0_values_plot1,I0_out_plot1,'-.','color',[0.30,0.75,0.93],'linewidth',2)
hold on
plot(I0_values_plot2,I0_out_plot2,'-','color',[0.49,0.18,0.56],'linewidth',2)
plot(I0_values_plot3,I0_out_plot3,'--','color','red','linewidth',2)
plot(I0_values_plot3,I0_out_plot4,':','color',[0.47,0.67,0.19],'linewidth',2)
%%
rc_vals_plot1 = [0.0107157894736842	0.0212315789473684	0.0317473684210526	0.0422631578947368	0.0527789473684211	0.0632947368421053	0.0738105263157895 0.0843263157894737	0.0948421052631579	0.105357894736842];
rc_vals_plot1=rc_vals_plot1/c;
rc_out_plot1 = [-2383.10453488301,-2302.88006046232,-2211.73755701286,-2110.03404004049,-1998.32977343650,-1876.43894366224,-1744.08628579615, -1600.39067128737,-1443.90844389120,-1271.42664255154];

rc_vals_plot2 = [0.0843263157894737	0.0948421052631579	0.105357894736842	0.115873684210526	0.126389473684211	0.136905263157895	0.147421052631579	0.157936842105263	0.168452631578947	0.178968421052632	0.189484210526316	0.200000000000000];
rc_vals_plot2=rc_vals_plot2/c;
rc_out_plot2 = [-1806.16710065480,-1536.38604467576,-1266.60498869502,-996.823932714815,-727.042876734556,-457.261820754149,-187.480764773868,82.3002912064576,352.081347187145,621.862403167161,891.643459147475,1161.42451512644];

rc_vals_plot3=[0.0843263157894737	0.0948421052631579	0.105357894736842];
rc_vals_plot3=rc_vals_plot3/c;
rc_out_plot3 = [-1806.47002436603,-1543.96306045592,-1294.99464323551];

figure()
plot(rc_vals_plot1,rc_out_plot1,'-','color',[0.49,0.18,0.56],'linewidth',2)
hold on
plot(rc_vals_plot2,rc_out_plot2,'--','color','red','linewidth',2)
plot(rc_vals_plot3,rc_out_plot3,':','color',[0.47,0.67,0.19],'linewidth',2)
xlabel("r/c")
ylabel("Economic Output")

%%
gamma_vals_plot1=[0.00100000000000000	0.00165517241379310	0.00231034482758621	0.00296551724137931	0.00362068965517241	0.00427586206896552	0.00493103448275862	0.00558620689655172	0.00624137931034483	0.00689655172413793	0.00755172413793104	0.00820689655172414	0.00886206896551724	0.00951724137931035	0.0101724137931035	0.0108275862068966	0.0114827586206897	0.0121379310344828	0.0127931034482759];
gamma_vals_plot2 = [0.00689655172413793	0.00755172413793104	0.00820689655172414	0.00886206896551724	0.00951724137931035	0.0101724137931035	0.0108275862068966	0.0114827586206897	0.0121379310344828	0.0127931034482759	0.0134482758620690	0.0141034482758621	0.0147586206896552	0.0154137931034483	0.0160689655172414	0.0167241379310345	0.0173793103448276	0.0180344827586207	0.0186896551724138	0.0193448275862069];
gamma_vals_plot3 = [0.00689655172413793	0.00755172413793104	0.00820689655172414	0.00886206896551724	0.00951724137931035	0.0101724137931035	0.0108275862068966	0.0114827586206897	0.0121379310344828	0.0127931034482759];

gamma_out_plot1=[-3362.06934069776,-3195.56306422245,-3030.17082584249,-2865.96379368437,-2703.01742624757,-2541.41237016657,-2381.23489062749,-2222.57717733815,-2065.53758960779,-1910.22082558912,-1756.73800808031,-1605.20666425113,-1455.75058017939,-1308.49950365576,-1163.58867153144,-1021.15813827308,-881.351883460964,-744.316681750738,-610.200725478361];
gamma_out_plot2=[-1973.83214322772,-1782.12627501206,-1597.64113721016,-1421.26473147085,-1253.23281255725,-1093.23944287179,-940.769711661373,-795.567311750885,-656.960471418699,-524.420590886832,-397.536537035669,-276.039439500996,-159.209020781721,-46.9011254201633,60.5578922304765,164.706461124294,265.182257653562,361.912730144534,455.612759021951,546.360151388274];
gamma_out_plot3=[-1976.93723079776,-1801.07535767714,-1634.30765131670,-1474.36645339687,-1319.89799383486,-1170.07232195413,-1024.42094573328,-882.723333484433,-744.706397264856,-610.246057386476];

figure()
plot(gamma_vals_plot1,gamma_out_plot1,'--r','linewidth',2)
hold on
plot(gamma_vals_plot2,gamma_out_plot2,'-','color',[0.49,0.18,0.56],'linewidth',2)
plot(gamma_vals_plot3,gamma_out_plot3,':','color',[0.47,0.67,0.19],'linewidth',2)

xlabel("\gamma")
ylabel("Economic Output")

%%
sigma_vals_plot1=[0	0.0526315789473684	0.105263157894737	0.157894736842105	0.210526315789474	0.263157894736842];
sigma_vals_plot2=[0	0.0526315789473684	0.105263157894737	0.157894736842105	0.210526315789474	0.263157894736842	0.315789473684211	0.368421052631579	0.421052631578947	0.473684210526316	0.526315789473684	0.578947368421053	0.631578947368421	0.684210526315790	0.736842105263158	0.789473684210526	0.842105263157895	0.894736842105263	0.947368421052632];
sigma_vals_plot3=[0.315789473684211	0.368421052631579	0.421052631578947	0.473684210526316	0.526315789473684	0.578947368421053	0.631578947368421	0.684210526315790	0.736842105263158	0.789473684210526	0.842105263157895	0.894736842105263	0.947368421052632];

sigma_out_plot1 = [-1225.43140882396,-1319.44698428632,-1413.46255974874,-1507.47813521140,-1601.49371067367,-1695.50928613643];
sigma_out_plot2 = [-1270.79896928885,-1346.67056644357,-1428.13625978949,-1514.06612770055,-1603.11697192172,-1695.37919814094];
sigma_out_plot3 = [-1266.53790442880,-1318.89979275650,-1366.18880647613,-1409.85857196206,-1450.66332499358,-1488.99620568931,-1525.20571495526,-1559.51050134888,-1592.08811630780,-1623.09784102676,-1652.67022332021,-1680.90674745201,-1707.89107771249,-1733.71835153366,-1758.45738574429,-1782.16285248386,-1804.87713337959,-1826.67119941294,-1847.61530460558];

figure()
plot(sigma_vals_plot1,sigma_out_plot1,'--r','linewidth',2)
hold on
plot(sigma_vals_plot1,sigma_out_plot2,':','color',[0.47,0.67,0.19],'linewidth',2)
plot(sigma_vals_plot2,sigma_out_plot3,'-','color',[0.49,0.18,0.56],'linewidth',2)

xlabel("\sigma")
ylabel("Economic Output")

%%

M_vals_plot1=[0.500000000000000	0.526315789473684	0.552631578947368	0.578947368421053	0.605263157894737	0.631578947368421	0.657894736842105	0.684210526315790	0.710526315789474	0.736842105263158];
M_vals_plot2=[0.763157894736842	0.789473684210526	0.815789473684211	0.842105263157895	0.868421052631579	0.894736842105263	0.921052631578947	0.947368421052632	0.973684210526316	1];
M_vals_plot3=[0.500000000000000	0.526315789473684	0.552631578947368	0.578947368421053	0.605263157894737	0.631578947368421	0.657894736842105	0.684210526315790	0.710526315789474	0.736842105263158	0.763157894736842	0.789473684210526	0.815789473684211	0.842105263157895	0.868421052631579	0.894736842105263	0.921052631578947	0.947368421052632	0.973684210526316	1];


M_out_plot2 = [-1542.40446082481,-1518.53422969656,-1493.35924062077,-1466.87829555328,-1439.09724798551,-1410.02801222922,-1379.68763544440,-1348.09744189723,-1315.28225419882,-1281.26969468273];
M_out_plot3 = [-1542.69859065887,-1519.91229370093,-1496.60240772009,-1473.01620300376,-1448.99573018372,-1424.73677133945,-1400.25191337833,-1375.45929985253,-1350.51570610409,-1325.61949311894];
M_out_plot4 = [-1452.56759840607,-1435.08532453042,-1417.62491504715,-1400.15523826623,-1382.67181818719,-1365.14957334349,-1347.54344171898,-1329.86804311150,-1312.09261546738,-1294.12978559770];

M_out_plot5 = [-1632.40986494156,-1613.75621470866,-1595.26863896157,-1576.99326028982,-1558.86839686668,-1540.89192814453,-1523.06797528332,-1505.33414491304,-1487.65631408843,-1470.07385919367,-1452.56759840607,-1435.08532453042,-1417.62491504715,-1400.15523826623,-1382.67181818719,-1365.14957334349,-1347.54344171898,-1329.86804311150,-1312.09261546738,-1294.12978559770];

figure()
plot(M_vals_plot3,M_out_plot5,'-','color',[0.49,0.18,0.56],'linewidth',2)
hold on
plot(M_vals_plot2,M_out_plot2,'--r','linewidth',2)
plot(M_vals_plot2,M_out_plot3,':','color',[0.47,0.67,0.19],'linewidth',2)

xlabel("Maximum mixing level, M")
ylabel("Economic Output")